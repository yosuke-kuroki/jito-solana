# Programming Model

The Solana *runtime* can execute untrusted on-chain programs written in any
programming language that can target the Berkley Packet Filter (BPF) safe
execution environment. The Solana SDK offers the best support for C programs,
which is compiled to BPF using the [LLVM compiler
infrastructure](https://llvm.org). Alternatively, a client might choose to
bypass LLVM and use Python, Lua or C++ to generate BPF directly via the [BPF
Compiler Collection](https://github.com/iovisor/bcc) (BCC).

## Deploying Programs to a Cluster

<img alt="SDK tools" src="img/sdk-tools.svg" class="center"/>

As shown in the diagram above a client creates a program and compiles it to an
ELF shared object containing BPF bytecode and sends it to the Solana cluster.
The cluster stores the program locally and makes it available to clients via a
*program ID*. The program ID is a public key generated by the client and is
used to reference the program in subsequent transactions.

## Interacting with On-chain Programs

After a program has been deployed, a client utilizes it by sending transactions
to the Solana cluster. A transaction contains one or more *instructions*. Each
instruction references the program ID that corresponds to the program that the
runtime should use to execute it. Instructions are executed atomically. If any
instruction is invalid, any changes made within the transaction are discarded.

## Storing State between Transactions

If the program needs to store state between transactions, it does so using
*accounts*. Accounts are similar to files in operating systems such as Linux.
Like files, an account may hold arbitrary data and that data persists beyond
the liftime of a program. Also like files, an account includes metadata that
tells the runtime who is allowed to access the data and how. Unlike files, the
account includes metadata for the liftime of the file. That lifetime is
expressed in "tokens", which is a number of fractional native tokens, called
*lamports*. Accounts are held in validator memory and pay "rent" to stay there.
Each fullnode periodically scan all accounts and collects rent. Any account
that drops to zero lamports is purged.

If an account is marked "executable", it will only be used by a *loader* to run
programs. For example, programs compiled to BPF are marked executable and
loaded by the BPF loader. No program is allowed to modify the contents of an
executable account.

Accounts also include "owner" metadata. The owner is the program ID. The
runtime grants the program write access to the account if its ID is the account
owner. If an account is not owned by a program, the program is permitted to
read its data and credit the account. There's one exception, however, accounts
owned by the `SystemProgram` may be written to and debited if the account
holder signed the transaction.

Accounts are identified by client-generated public keys. When the client sends
transactions to programs, it requests access to accounts using those keys. The
runtime loads the account and passes it to the program. After the program
finishes executing, the runtime uses the account metadata to verify that none
of the access rules were violated, and if so, discards those changes, and marks
the transaction as failed.
